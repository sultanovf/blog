{
  "hash": "4d421a8ce74ebf553f250207f33393b9",
  "result": {
    "markdown": "---\ntitle: \"animated barplot\"\ndescription: \"#part_2: an *animated barplot* for the development of food price of some products in Uzbekistan over year and months using `ggplot2` and `gganimate`\"\nauthor: \"Fazliddin Sultonov\"\ndate: \"2025-02-08\"\ndate-format: \"MMM D, YYYY\"\n\nfilters:\n  - lightbox\nlightbox: \n  match: auto\n  effect: none\n  desc-position: top\n\npage-layout: full\nreference-location: margin\ncategories: [barplot, R, ggplot2, gganimate, geom_image]\n# Code execute options\nexecute: \n  echo: true    # Input anzeigen\n  eval: true    # Code ausführen\n  freeze: true  # never re-render during project render\n# Output\nformat: \n  html:\n    theme: cosmo\n    #embed-resources: true\n  # codeb block\n    code-fold: true\n    code-line-numbers: true\n    code-block-border-left: true\n  # engine\n    engine: knitr\n    css: /customs/style.css\n# engine: knitr\n#jupyter: python3\n\n# Chunk Options\nknitr:\n  opts_chunk:\n    comment: \"#>\" \n\n  opts_knit: \n    warning: false\n    error: false\n    \n---\n\n\n\n![](gallery_img/bar_prod.png)\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n:::: {.column-screen}\n::: {.code-r}\n# `<svg preserveAspectRatio=\"none\" aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 581 512\" style=\"height:2.0em;width:2.0em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:steelblue;overflow:visible;position:relative;\"><path d=\"M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z\"/></svg>`{=html}{.center-slide}\n\n:::\n::::\n\n\nDatasource: [Statistics Agency under the President of the Republic of Uzbekistan](https://stat.uz/en/) |\nDatastorage: [{{< fa brands square-github >}}GitHub](https://github.com/sultanovf/my_datasets/blob/main/priceuz_202101-202411.csv)\n\n\n## Data\n\n\n::: {.cell .column-screen-inset}\n\n```{.r .cell-code}\ndata_raw <- read.csv2(\n  \"https://raw.githubusercontent.com/sultanovf/my_datasets/refs/heads/main/priceuz_202101-202411.csv\")\n\n  \nprice_uz <-\n  data_raw |> \n  select(-runame) |> \n  add_column(runame, .after = \"enname\" )\n\ndatseq <- as.character(seq(as.Date(\"2021-01-01\"),as.Date(\"2024-11-01\"), by = \"month\"))\nnew_colnames <- c(\"uzname\", \"enname\", \"runame\", unlist(strsplit(datseq, \",\")))\ncolnames(price_uz) <- new_colnames\n\n\nrmarkdown::paged_table(sample_n(price_uz, 10)) # show sample 10 rows\n# oder {r, df_print = \"paged\"}\n# sample_n(data_raw, 10\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"uzname\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"enname\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"runame\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"2021-01-01\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2021-02-01\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2021-03-01\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2021-04-01\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2021-05-01\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2021-06-01\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2021-07-01\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2021-08-01\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2021-09-01\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2021-10-01\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2021-11-01\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2021-12-01\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2022-01-01\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2022-02-01\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2022-03-01\"],\"name\":[18],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2022-04-01\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2022-05-01\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2022-06-01\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2022-07-01\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2022-08-01\"],\"name\":[23],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2022-09-01\"],\"name\":[24],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2022-10-01\"],\"name\":[25],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2022-11-01\"],\"name\":[26],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2022-12-01\"],\"name\":[27],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2023-01-01\"],\"name\":[28],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2023-02-01\"],\"name\":[29],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2023-03-01\"],\"name\":[30],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2023-04-01\"],\"name\":[31],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2023-05-01\"],\"name\":[32],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2023-06-01\"],\"name\":[33],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2023-07-01\"],\"name\":[34],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2023-08-01\"],\"name\":[35],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2023-09-01\"],\"name\":[36],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2023-10-01\"],\"name\":[37],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2023-11-01\"],\"name\":[38],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2023-12-01\"],\"name\":[39],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2024-01-01\"],\"name\":[40],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2024-02-01\"],\"name\":[41],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2024-03-01\"],\"name\":[42],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2024-04-01\"],\"name\":[43],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2024-05-01\"],\"name\":[44],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2024-06-01\"],\"name\":[45],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2024-07-01\"],\"name\":[46],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2024-08-01\"],\"name\":[47],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2024-09-01\"],\"name\":[48],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2024-10-01\"],\"name\":[49],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2024-11-01\"],\"name\":[50],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Pomidor\",\"2\":\"Tomatoes\",\"3\":\"Помидоры\",\"4\":\"10820.4\",\"5\":\"11566.5\",\"6\":\"15408.0\",\"7\":\"14976.5\",\"8\":\"10031.5\",\"9\":\"5552.6\",\"10\":\"3512.2\",\"11\":\"3570.6\",\"12\":\"4341.3\",\"13\":\"6072.4\",\"14\":\"9789.3\",\"15\":\"11900.5\",\"16\":\"14423.5\",\"17\":\"14911.4\",\"18\":\"16704.8\",\"19\":\"17195.6\",\"20\":\"13193.9\",\"21\":\"7828.1\",\"22\":\"4045.6\",\"23\":\"4758.4\",\"24\":\"6623.9\",\"25\":\"7914.6\",\"26\":\"11334.7\",\"27\":\"14388.1\",\"28\":\"18572.2\",\"29\":\"20089.6\",\"30\":\"25936.9\",\"31\":\"32207.3\",\"32\":\"15259.7\",\"33\":\"6232.9\",\"34\":\"4749.4\",\"35\":\"4252.4\",\"36\":\"4432.7\",\"37\":\"6749.4\",\"38\":\"14503.5\",\"39\":\"24277.8\",\"40\":\"28910.4\",\"41\":\"28221.6\",\"42\":\"28034.9\",\"43\":\"28369.5\",\"44\":\"20000.4\",\"45\":\"10263.5\",\"46\":\"5018.4\",\"47\":\"4824.8\",\"48\":\"6356.0\",\"49\":\"8484.2\",\"50\":\"16168.7\"},{\"1\":\"Sabzi\",\"2\":\"Carrot\",\"3\":\"Морковь\",\"4\":\"2073.2\",\"5\":\"2039.7\",\"6\":\"2181.3\",\"7\":\"2895.9\",\"8\":\"3691.2\",\"9\":\"6920.6\",\"10\":\"7009.0\",\"11\":\"6130.3\",\"12\":\"5166.4\",\"13\":\"3950.2\",\"14\":\"2627.3\",\"15\":\"2261.7\",\"16\":\"2323.2\",\"17\":\"2458.0\",\"18\":\"2640.0\",\"19\":\"3092.9\",\"20\":\"3315.3\",\"21\":\"3215.6\",\"22\":\"2986.1\",\"23\":\"2858.8\",\"24\":\"2827.8\",\"25\":\"3000.0\",\"26\":\"3174.2\",\"27\":\"3128.5\",\"28\":\"3375.7\",\"29\":\"3702.6\",\"30\":\"3535.0\",\"31\":\"3831.6\",\"32\":\"4063.2\",\"33\":\"3958.5\",\"34\":\"4240.9\",\"35\":\"4772.4\",\"36\":\"5124.0\",\"37\":\"4311.8\",\"38\":\"3292.8\",\"39\":\"2927.5\",\"40\":\"2904.1\",\"41\":\"2735.1\",\"42\":\"2743.2\",\"43\":\"2759.4\",\"44\":\"2814.4\",\"45\":\"2877.1\",\"46\":\"2911.3\",\"47\":\"3188.8\",\"48\":\"3609.3\",\"49\":\"3688.5\",\"50\":\"3523.5\"},{\"1\":\"Un(1-navli)\",\"2\":\"First grade wheat flour\",\"3\":\"Мука(первого сорта)\",\"4\":\"4119.8\",\"5\":\"4134.4\",\"6\":\"4128.1\",\"7\":\"4234.5\",\"8\":\"4265.4\",\"9\":\"4258.3\",\"10\":\"4261.9\",\"11\":\"4275.7\",\"12\":\"4277.5\",\"13\":\"4298.8\",\"14\":\"4343.6\",\"15\":\"4379.7\",\"16\":\"4417.3\",\"17\":\"4465.5\",\"18\":\"4477.5\",\"19\":\"4569.3\",\"20\":\"4875.9\",\"21\":\"5932.7\",\"22\":\"6009.7\",\"23\":\"6070.8\",\"24\":\"6195.8\",\"25\":\"6705.3\",\"26\":\"6781.3\",\"27\":\"6841.7\",\"28\":\"7233.7\",\"29\":\"7143.7\",\"30\":\"7043.3\",\"31\":\"6799.0\",\"32\":\"6538.7\",\"33\":\"6431.3\",\"34\":\"6304.6\",\"35\":\"6174.3\",\"36\":\"6463.5\",\"37\":\"6813.2\",\"38\":\"6800.1\",\"39\":\"6813.2\",\"40\":\"6703.7\",\"41\":\"6619.7\",\"42\":\"6567.4\",\"43\":\"6549.9\",\"44\":\"6501.7\",\"45\":\"6467.9\",\"46\":\"6464.1\",\"47\":\"6461.2\",\"48\":\"6477.6\",\"49\":\"6493.1\",\"50\":\"6500.8\"},{\"1\":\"Kepak\",\"2\":\"Bran\",\"3\":\"Отруби\",\"4\":\"2114.0\",\"5\":\"2114.7\",\"6\":\"2168.9\",\"7\":\"2352.6\",\"8\":\"2489.2\",\"9\":\"2499.7\",\"10\":\"2510.1\",\"11\":\"2533.0\",\"12\":\"2546.4\",\"13\":\"2566.9\",\"14\":\"2626.4\",\"15\":\"2682.0\",\"16\":\"2676.7\",\"17\":\"2743.7\",\"18\":\"2777.4\",\"19\":\"2817.5\",\"20\":\"2858.5\",\"21\":\"2934.6\",\"22\":\"2952.3\",\"23\":\"3072.7\",\"24\":\"3087.5\",\"25\":\"3148.6\",\"26\":\"3165.7\",\"27\":\"3183.7\",\"28\":\"3109.8\",\"29\":\"3142.7\",\"30\":\"3146.7\",\"31\":\"3146.7\",\"32\":\"3175.8\",\"33\":\"3282.3\",\"34\":\"3246.4\",\"35\":\"3228.5\",\"36\":\"3219.0\",\"37\":\"3190.2\",\"38\":\"3154.3\",\"39\":\"3120.2\",\"40\":\"3090.5\",\"41\":\"3033.5\",\"42\":\"3009.8\",\"43\":\"2999.6\",\"44\":\"3031.2\",\"45\":\"3011.8\",\"46\":\"2973.7\",\"47\":\"2945.4\",\"48\":\"2941.1\",\"49\":\"2914.9\",\"50\":\"2873.6\"},{\"1\":\"Yog(paxta)\",\"2\":\"Cottonseed oil (1 liter)\",\"3\":\"Масло(хлопковое)\",\"4\":\"13082.2\",\"5\":\"13189.1\",\"6\":\"13346.9\",\"7\":\"16097.5\",\"8\":\"16971.7\",\"9\":\"16849.8\",\"10\":\"16873.4\",\"11\":\"16948.0\",\"12\":\"17029.9\",\"13\":\"17005.1\",\"14\":\"17040.2\",\"15\":\"16940.4\",\"16\":\"16826.5\",\"17\":\"16747.9\",\"18\":\"16863.0\",\"19\":\"17311.2\",\"20\":\"17725.0\",\"21\":\"18369.7\",\"22\":\"18596.2\",\"23\":\"18773.8\",\"24\":\"18862.0\",\"25\":\"19086.8\",\"26\":\"18979.7\",\"27\":\"18733.1\",\"28\":\"18512.7\",\"29\":\"18475.5\",\"30\":\"18289.6\",\"31\":\"17733.2\",\"32\":\"17148.9\",\"33\":\"16751.6\",\"34\":\"16429.8\",\"35\":\"16267.1\",\"36\":\"16163.9\",\"37\":\"16023.5\",\"38\":\"15823.9\",\"39\":\"15486.5\",\"40\":\"15145.7\",\"41\":\"14150.1\",\"42\":\"13544.7\",\"43\":\"13291.9\",\"44\":\"13183.8\",\"45\":\"13118.3\",\"46\":\"13249.4\",\"47\":\"13676.0\",\"48\":\"14146.2\",\"49\":\"14600.8\",\"50\":\"15596.8\"},{\"1\":\"Sarimsoq\",\"2\":\"Garlic\",\"3\":\"Чеснок\",\"4\":\"22186.1\",\"5\":\"22044.8\",\"6\":\"22212.2\",\"7\":\"23005.7\",\"8\":\"20356.4\",\"9\":\"15382.2\",\"10\":\"15313.6\",\"11\":\"16107.8\",\"12\":\"17282.7\",\"13\":\"19312.1\",\"14\":\"21364.6\",\"15\":\"23850.2\",\"16\":\"26989.5\",\"17\":\"27898.4\",\"18\":\"28398.3\",\"19\":\"27598.2\",\"20\":\"21119.6\",\"21\":\"15526.2\",\"22\":\"15438.2\",\"23\":\"16018.1\",\"24\":\"16290.5\",\"25\":\"16337.1\",\"26\":\"16660.4\",\"27\":\"17619.5\",\"28\":\"19353.5\",\"29\":\"20352.8\",\"30\":\"20972.5\",\"31\":\"21562.5\",\"32\":\"20191.8\",\"33\":\"17550.1\",\"34\":\"17407.8\",\"35\":\"17451.9\",\"36\":\"18576.7\",\"37\":\"20228.3\",\"38\":\"23745.3\",\"39\":\"27457.8\",\"40\":\"32693.4\",\"41\":\"35042.8\",\"42\":\"35957.3\",\"43\":\"36635.7\",\"44\":\"32197.9\",\"45\":\"23344.9\",\"46\":\"22614.9\",\"47\":\"23854.4\",\"48\":\"26838.0\",\"49\":\"29921.2\",\"50\":\"32116.4\"},{\"1\":\"Qoy goshti\",\"2\":\"Mutton\",\"3\":\"Баранина\",\"4\":\"61937.0\",\"5\":\"62278.6\",\"6\":\"62521.9\",\"7\":\"63129.3\",\"8\":\"64141.9\",\"9\":\"64653.6\",\"10\":\"65446.8\",\"11\":\"67055.1\",\"12\":\"67743.0\",\"13\":\"67833.0\",\"14\":\"68031.3\",\"15\":\"67316.1\",\"16\":\"67392.6\",\"17\":\"67731.7\",\"18\":\"67770.9\",\"19\":\"67630.8\",\"20\":\"68031.7\",\"21\":\"68738.4\",\"22\":\"69528.5\",\"23\":\"70425.2\",\"24\":\"71005.3\",\"25\":\"72276.0\",\"26\":\"72865.2\",\"27\":\"73279.7\",\"28\":\"74780.5\",\"29\":\"75698.4\",\"30\":\"76411.4\",\"31\":\"77141.3\",\"32\":\"78275.3\",\"33\":\"79344.3\",\"34\":\"79680.9\",\"35\":\"80241.1\",\"36\":\"80840.6\",\"37\":\"80885.7\",\"38\":\"81273.5\",\"39\":\"81508.7\",\"40\":\"81229.4\",\"41\":\"80577.8\",\"42\":\"79937.1\",\"43\":\"79990.9\",\"44\":\"80350.1\",\"45\":\"81013.6\",\"46\":\"82075.2\",\"47\":\"85868.4\",\"48\":\"89296.8\",\"49\":\"91066.3\",\"50\":\"91719.9\"},{\"1\":\"Un(oliy navli)\",\"2\":\"High-grade wheat flour\",\"3\":\"Мука(высшего)\",\"4\":\"5385.7\",\"5\":\"5494.9\",\"6\":\"5637.4\",\"7\":\"5683.3\",\"8\":\"5695.5\",\"9\":\"5675.1\",\"10\":\"5669.2\",\"11\":\"5712.1\",\"12\":\"5719.4\",\"13\":\"5768.2\",\"14\":\"5845.3\",\"15\":\"5881.9\",\"16\":\"5848.7\",\"17\":\"5927.6\",\"18\":\"5957.6\",\"19\":\"6044.7\",\"20\":\"6283.9\",\"21\":\"7219.8\",\"22\":\"7385.7\",\"23\":\"7473.5\",\"24\":\"7638.9\",\"25\":\"8393.9\",\"26\":\"8655.6\",\"27\":\"8919.7\",\"28\":\"9428.5\",\"29\":\"9486.7\",\"30\":\"9472.6\",\"31\":\"9327.1\",\"32\":\"9124.0\",\"33\":\"9009.2\",\"34\":\"8898.6\",\"35\":\"8699.5\",\"36\":\"8886.1\",\"37\":\"9283.7\",\"38\":\"9318.2\",\"39\":\"9319.9\",\"40\":\"9158.0\",\"41\":\"9145.0\",\"42\":\"9130.7\",\"43\":\"9155.6\",\"44\":\"9197.7\",\"45\":\"9206.0\",\"46\":\"9219.6\",\"47\":\"9242.1\",\"48\":\"9569.7\",\"49\":\"9614.9\",\"50\":\"9580.9\"},{\"1\":\"Bugdoy\",\"2\":\"Wheat\",\"3\":\"Пшеница\",\"4\":\"3254.8\",\"5\":\"3261.3\",\"6\":\"3260.2\",\"7\":\"3346.2\",\"8\":\"3444.4\",\"9\":\"3377.5\",\"10\":\"3232.0\",\"11\":\"3198.5\",\"12\":\"3203.4\",\"13\":\"3259.5\",\"14\":\"3403.5\",\"15\":\"3515.3\",\"16\":\"3585.9\",\"17\":\"3677.1\",\"18\":\"3739.1\",\"19\":\"3856.2\",\"20\":\"4035.2\",\"21\":\"4392.8\",\"22\":\"4358.0\",\"23\":\"4351.6\",\"24\":\"4335.1\",\"25\":\"4351.7\",\"26\":\"4394.0\",\"27\":\"4417.1\",\"28\":\"4253.7\",\"29\":\"4272.3\",\"30\":\"4285.1\",\"31\":\"4240.6\",\"32\":\"4175.1\",\"33\":\"4121.3\",\"34\":\"3843.7\",\"35\":\"3689.5\",\"36\":\"3649.0\",\"37\":\"3698.5\",\"38\":\"3656.9\",\"39\":\"3637.2\",\"40\":\"3618.6\",\"41\":\"3593.6\",\"42\":\"3584.5\",\"43\":\"3595.0\",\"44\":\"3589.8\",\"45\":\"3519.6\",\"46\":\"3338.4\",\"47\":\"3258.6\",\"48\":\"3275.0\",\"49\":\"3301.3\",\"50\":\"3316.2\"},{\"1\":\"Bulgor qalampiri\",\"2\":\"Bell pepper\",\"3\":\"Перец болгарский\",\"4\":\"20474.4\",\"5\":\"28087.3\",\"6\":\"38542.6\",\"7\":\"31637.9\",\"8\":\"17666.1\",\"9\":\"6351.9\",\"10\":\"3962.3\",\"11\":\"3519.7\",\"12\":\"3792.8\",\"13\":\"4477.8\",\"14\":\"7868.2\",\"15\":\"13092.9\",\"16\":\"18229.5\",\"17\":\"22636.7\",\"18\":\"27846.0\",\"19\":\"30127.6\",\"20\":\"19019.4\",\"21\":\"10071.9\",\"22\":\"6577.5\",\"23\":\"5939.2\",\"24\":\"6034.9\",\"25\":\"6949.9\",\"26\":\"9867.4\",\"27\":\"15195.9\",\"28\":\"25324.8\",\"29\":\"36882.9\",\"30\":\"44600.2\",\"31\":\"48217.6\",\"32\":\"21199.0\",\"33\":\"8719.2\",\"34\":\"6466.1\",\"35\":\"5758.6\",\"36\":\"5830.1\",\"37\":\"6145.2\",\"38\":\"8547.8\",\"39\":\"15334.0\",\"40\":\"29296.3\",\"41\":\"36171.9\",\"42\":\"43477.0\",\"43\":\"45506.5\",\"44\":\"25186.8\",\"45\":\"12552.2\",\"46\":\"7446.2\",\"47\":\"6334.2\",\"48\":\"6589.0\",\"49\":\"7954.8\",\"50\":\"14080.0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n## dataclean\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add column catecory\ndf_data <- price_uz |> \n  select(-enname) |> \n  filter(uzname %in% filtermap) |> \n  mutate(\n    category = case_when(\n      uzname %in% gosht ~ \"Мясо\",\n      uzname %in% sabzavot ~ \"Овощи\",\n      uzname %in% oziqovqat ~ \"Питание\",\n      uzname %in% yog ~ \"Mасло\",\n      TRUE ~ \"Другой\"\n    )\n  )\n\n# pivot data\ndf_piv <-\n  df_data |> \n  pivot_longer(\n    cols = !c(uzname, runame, category),\n    names_to = \"date\",\n    values_to = \"price\"\n  ) |> \n  mutate(\n    date = as.Date(date)\n  ) \n\ndf_piv |> \n  sample_n(7)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> # A tibble: 7 × 5\n#>   uzname       runame          category date        price\n#>   <chr>        <chr>           <chr>    <date>      <dbl>\n#> 1 Non          Хлеб            Питание  2024-10-01  6114.\n#> 2 Guruch       Рис             Питание  2024-04-01 20045.\n#> 3 Tovuq goshti Курица          Мясо     2022-10-01 26676.\n#> 4 Mol goshti   Говядина        Мясо     2021-01-01 59082.\n#> 5 Sariyog      Масло сливочное Mасло    2021-05-01 51568 \n#> 6 Tovuq goshti Курица          Мясо     2023-11-01 31566.\n#> 7 Non          Хлеб            Питание  2023-08-01  5776.\n```\n:::\n:::\n\n\n\n## Prepare Data for Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf2 <- \n  df_piv |>\n  filter(\n    !(runame %in% c(\"Баранина\", \"Говядина\", \"Масло сливочное\", \"Курица\"))\n  ) |> \n  arrange(date,price) |>\n  group_by(date) |>\n  # mutate(date = format(date, \"%Y %b\")) |>\n  mutate(\n    images = case_when(\n      runame == \"Пшеница\" ~ paste0(img_path,uzname,\".png\"),\n      runame == \"Рис\" ~ paste0(img_path,uzname,\".png\"),\n      runame == \"Хлеб\" ~ paste0(img_path,uzname,\".png\"),\n      runame == \"Масло(хлопковое)\" ~ paste0(img_path,uzname,\".png\"),\n      runame == \"Масло(подсолнечное)\" ~ paste0(img_path,uzname,\".png\"),\n      runame == \"Морковь\" ~ paste0(img_path,uzname,\".png\"),\n      runame == \"Чеснок\" ~ paste0(img_path,uzname,\".png\"),\n      runame == \"Лук\" ~ paste0(img_path,uzname,\".png\"),\n      runame == \"Картофель\" ~ paste0(img_path,uzname,\".png\"),\n      runame == \"Сахар\" ~ paste0(img_path,uzname,\".png\"),\n      TRUE ~ uzname\n      \n    ),\n    frame = row_number(),\n    rank = 1:n(),\n    #ord_runame = (fct_reorder(runame, price))\n  ) |>  ungroup()\n\nhead(df2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> # A tibble: 6 × 8\n#>   uzname    runame    category date       price images               frame  rank\n#>   <chr>     <chr>     <chr>    <date>     <dbl> <chr>                <int> <int>\n#> 1 Sabzi     Морковь   Овощи    2021-01-01 2073. gallery_img/product…     1     1\n#> 2 Piyoz     Лук       Овощи    2021-01-01 2081. gallery_img/product…     2     2\n#> 3 Non       Хлеб      Питание  2021-01-01 3137. gallery_img/product…     3     3\n#> 4 Bugdoy    Пшеница   Питание  2021-01-01 3255. gallery_img/product…     4     4\n#> 5 Kartoshka Картофель Овощи    2021-01-01 4033. gallery_img/product…     5     5\n#> 6 Shakar    Сахар     Питание  2021-01-01 7360. gallery_img/product…     6     6\n```\n:::\n:::\n\n\n\n## Plot animatet #1\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Title/subtitle/legendtitle\nt2 <- paste(\"Цены на продукты питания\")\np2 <- paste(\"категории: \") \n\n\nf_path <- \"C:/Users/sultanov/Documents/fontawesome/otfs/\"\nfont_add('Font Awesome 6 Brands', paste0(f_path, \"Font Awesome 6 Brands-Regular-400.otf\"))\n\nshowtext::showtext_auto()\n\np_df2 <-\n  df2 |> \n  ggplot(aes(\n    x= rank,\n    y = price,\n    fill = category))+ #    color = runame\n  geom_col()+\n  geom_text(aes(label = as.character(price)), hjust = 0, size = 4) +\n  geom_image(aes(x = rank,  image = images),y = 0,   size = 0.1)+ \n  \n  \n  scale_y_continuous(\n    limits = c(0,40000),breaks = seq(0, 40000, 5000),\n    labels = function(x) paste0(x/1000, \"k\"),\n    expand = expansion(c(0.09, 0.02))) +\n  #expand_limits(y = 0)+\n  #scale_y_continuous(labels = scales::comma) + # Format y-axis values\n  #scale_x_reverse() +   # put rank 1 at the top/ Highest values on top\n  #guides(color = FALSE, fill = FALSE)+\n  \n  coord_flip(clip = \"off\", expand = FALSE) +\n  geom_label(aes(label = paste(\"Time:\",format(date, \"%Y %b\"))),\n             x = 1.6, y = 32000, size = 7, fill = \"floralwhite\", col = \"gray\")+\n  labs(title = t2,\n       subtitle = \"DataSource: ©Агентство статистики при Президенте Республики Узбекистан\",\n       caption = social_caption_map, \n       x = \"продукты\", \n       y = \"цены в тысячах(k = 1000)\",\n       fill = p2) +\n\n  theme_minimal()+\n  theme(plot.title = element_text(size = 16, hjust = 0.5 ),\n        plot.subtitle = element_text(size = 14, color = \"steelblue4\", hjust = 0.5),\n        plot.caption = ggtext::element_markdown(size = 12, hjust = 0.5),\n        legend.position = \"top\",\n        axis.text.y = element_blank(),\n        axis.title.y = element_text(vjust = 11, size = 9),\n        axis.title.x = element_text(size = 10),\n        legend.box.background =element_rect(\"floralwhite\")) +\n  \n  transition_states(date)+\n  ease_aes(\"cubic-in-out\") + #bounce-in cubic-in-out\n  enter_fade() +\n  exit_fade()\n\np_df2\n\n# anim_1 <- p_df2 |>\n#   animate(\n#     duration = 20,\n#     fps = 10,\n#     start_pause = 5,\n#     end_pause = 5,\n#     #height = 530,\n#     #width = 832,\n#     #rewind = TRUE,\n#     renderer = av_renderer()\n#   )\n# anim_1\n```\n\n::: {.cell-output-display}\n![](price_bar_files/figure-html/unnamed-chunk-6-1.gif)\n:::\n:::\n\n\n## Plot animated #2\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1_df2<- df2 |> \n  ggplot(aes(\n    xmin= 0,\n    xmax = price,\n    y = rank,\n    ymin = rank - 0.45,\n    ymax = rank + 0.45,\n    group = runame,\n    fill = category))+\n  geom_rect(alpha = 0.5) +\n  \n  facet_wrap(~date) +\n  facet_null() +\n  \n  scale_x_continuous(\n    limits = c(0,40000),breaks = seq(0, 40000, 5000),\n    labels = function(x) paste0(x/1000, \"k\"),\n    expand = expansion(c(0.05, 0.02)))+\n\n  geom_image(aes(x=price, image = images), x= 0, size = 0.1)+\n  geom_text(aes(label = paste(\"Time:\", format(date, \"%Y %b\"))),\n             x = 32000, y = 1.5, size = 6, color = \"tomato4\")+\n  \n  \n  geom_label(aes(x = price, label = as.character(price)), colour = \"white\")+\n  \n  labs(title = t2, \n       subtitle = \"DataSource: ©Агентство статистики при Президенте Республики Узбекистан\",\n       caption = social_caption_map,\n       x = \"цены в тысячах (k = 1000)\", y = \"продукты\", \n       fill = p2)+   # legend title\n  theme_minimal()+\n  theme(\n    plot.title = element_text(size = 16, color = \"steelblue4\", hjust = 0.5),\n    plot.subtitle = element_text(size = 14, color = \"tomato4\", hjust = 0.5),\n    plot.caption = element_textbox_simple(\n      size = 12,\n      lineheight = 1,\n      padding = margin(5.5, 5.5, 5.5, 5.5),\n      margin = margin(0, 0, 5.5, 0),\n      hjust = -0.5,\n      fill = \"cornsilk\"), #\n    axis.ticks.y = element_blank(), \n    axis.text.y = element_blank(),\n    # panel.grid.major.y = element_blank(),\n    # panel.grid.minor.y = element_blank(),\n    legend.position = \"top\",\n    legend.box.background =element_rect(\"floralwhite\")) +\n  \n  transition_reveal(date)+\n  enter_fade() +\n  exit_fade()\n\np1_df2\n\n# anim_2 <- p1_df2 |>\n#   animate(\n#     duration = 20,\n#     fps = 10,\n#     start_pause = 5,\n#     end_pause = 5,\n#     # height = 530, #530\n#     #width = 844, #633\n#     #rewind = TRUE,\n#     renderer = av_renderer()\n#   )\n# anim_2\n```\n\n::: {.cell-output-display}\n![](price_bar_files/figure-html/unnamed-chunk-7-1.gif)\n:::\n:::\n\n\n\n## Saved as Video\n\n<!-- {{< video plots/price_bar.mp4 title=\"Test\" aspect-ratio=\"16x9\" >}} -->\n\n\n![](plots/price_bar.mp4)\n\n\n\n",
    "supporting": [
      "price_bar_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}