{
  "hash": "0df76e1c63c02a79b06e58bc96ed7920",
  "result": {
    "markdown": "---\ntitle: \"population in GIS countries\"\ndescription: \"population in CIS countries in bar plot, range plot and treemap (animated) using `ggplot2` and `gganimate`\"\nauthor: \"Fazliddin Sultonov\"\ndate: \"2025-04-05\"\ndate-format: \"MMM D, YYYY\"\n\nfilters:\n  - lightbox\nlightbox: \n  match: auto\n  effect: none\n  desc-position: top\n\npage-layout: full\nreference-location: margin\ncategories: [barplot, R, ggplot2, gganimate, CGPfunctions, rangeplot, slopegraph, treemap]\n# Code execute options\nexecute: \n  echo: true    # Input anzeigen\n  eval: true    # Code ausführen\n  freeze: true  # never re-render during project render\n# Output\nformat: \n  html:\n    theme: cosmo\n  # codeb block\n    code-fold: true\n    code-line-numbers: true\n    code-block-border-left: true\n  # engine\n    engine: knitr\n    css: /customs/style.css\n# engine: knitr\n#jupyter: python3\n\n# Chunk Options\nknitr:\n  opts_chunk:\n    comment: \"#>\" \n\n  opts_knit: \n    warning: false\n    error: false\n    \n---\n\n\n\n![](gallery_img/pop_gis.png)\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n:::: {.column-screen}\n::: {.code-r}\n# `<svg preserveAspectRatio=\"none\" aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 581 512\" style=\"height:2.0em;width:2.0em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:steelblue;overflow:visible;position:relative;\"><path d=\"M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z\"/></svg>`{=html}{.center-slide}\n\n:::\n::::\n\n\nDatasource: [World Bank](https://data.worldbank.org/)\n\n\n\n## raw data\n\n\n::: {.cell .column-screen-inset}\n\n```{.r .cell-code}\ndataraw <- read.csv2(\"data/pop_cis.csv\") # , sep = \";\",encoding = \"utf-8\"\nyears <- paste(1960:2024) #, sep=\",\", collapse= \",\"\nyears <- unlist(strsplit(years, \",\"))\nnew_cnames <- c(\"country\", \"ccode\",  years)\ncolnames(dataraw) <- new_cnames\n\n\ndata <- dataraw\nrmarkdown::paged_table(head(data)) # show sample 10 rows\n# oder {r, df_print = \"paged\"}\n# sample_n(data_raw, 10\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"country\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"ccode\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"1960\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1961\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1962\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1963\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1964\"],\"name\":[7],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1965\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1966\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1967\"],\"name\":[10],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1968\"],\"name\":[11],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1969\"],\"name\":[12],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1970\"],\"name\":[13],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1971\"],\"name\":[14],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1972\"],\"name\":[15],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1973\"],\"name\":[16],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1974\"],\"name\":[17],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1975\"],\"name\":[18],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1976\"],\"name\":[19],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1977\"],\"name\":[20],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1978\"],\"name\":[21],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1979\"],\"name\":[22],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1980\"],\"name\":[23],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1981\"],\"name\":[24],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1982\"],\"name\":[25],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1983\"],\"name\":[26],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1984\"],\"name\":[27],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1985\"],\"name\":[28],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1986\"],\"name\":[29],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1987\"],\"name\":[30],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1988\"],\"name\":[31],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1989\"],\"name\":[32],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1990\"],\"name\":[33],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1991\"],\"name\":[34],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1992\"],\"name\":[35],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1993\"],\"name\":[36],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1994\"],\"name\":[37],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1995\"],\"name\":[38],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"1996\"],\"name\":[39],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1997\"],\"name\":[40],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1998\"],\"name\":[41],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"1999\"],\"name\":[42],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"2000\"],\"name\":[43],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2001\"],\"name\":[44],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2002\"],\"name\":[45],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"2003\"],\"name\":[46],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"2004\"],\"name\":[47],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2005\"],\"name\":[48],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2006\"],\"name\":[49],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"2007\"],\"name\":[50],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2008\"],\"name\":[51],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"2009\"],\"name\":[52],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"2010\"],\"name\":[53],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"2011\"],\"name\":[54],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2012\"],\"name\":[55],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"2013\"],\"name\":[56],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"2014\"],\"name\":[57],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2015\"],\"name\":[58],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2016\"],\"name\":[59],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2017\"],\"name\":[60],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2018\"],\"name\":[61],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2019\"],\"name\":[62],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"2020\"],\"name\":[63],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2021\"],\"name\":[64],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"2022\"],\"name\":[65],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2023\"],\"name\":[66],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"2024\"],\"name\":[67],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Armenia\",\"2\":\"ARM\",\"3\":\"1863705\",\"4\":\"1927484\",\"5\":\"1991689\",\"6\":\"2056023\",\"7\":\"2120135\",\"8\":\"2183635\",\"9\":\"2246159\",\"10\":\"2307492\",\"11\":\"2367319\",\"12\":\"2424030\",\"13\":\"2475633\",\"14\":\"2525345\",\"15\":\"2577079\",\"16\":\"2630860\",\"17\":\"2686445\",\"18\":\"2743660\",\"19\":\"2818165\",\"20\":\"2912827\",\"21\":\"3012807\",\"22\":\"3078501\",\"23\":\"3107415\",\"24\":\"3135349\",\"25\":\"3163144\",\"26\":\"3191539\",\"27\":\"3224547\",\"28\":\"3260432\",\"29\":\"3294847\",\"30\":\"3328520\",\"31\":\"3355125\",\"32\":\"3443100\",\"33\":\"3552128\",\"34\":\"3613977\",\"35\":\"3571861\",\"36\":\"3453332\",\"37\":\"3364610\",\"38\":\"3307581\",\"39\":\"3278735\",\"40\":\"3246289\",\"41\":\"3208401\",\"42\":\"3167286\",\"43\":\"3221100\",\"44\":\"3211800\",\"45\":\"3199800\",\"46\":\"3182500\",\"47\":\"3164900\",\"48\":\"3146400\",\"49\":\"3127100\",\"50\":\"3107400\",\"51\":\"3087100\",\"52\":\"3066000\",\"53\":\"3044800\",\"54\":\"3027900\",\"55\":\"3024100\",\"56\":\"3022000\",\"57\":\"3013800\",\"58\":\"3004600\",\"59\":\"2992300\",\"60\":\"2979400\",\"61\":\"2969000\",\"62\":\"2962500\",\"63\":\"2961500\",\"64\":\"2962300\",\"65\":\"2969200\",\"66\":\"2990900\",\"67\":\"2973841\",\"_rn_\":\"1\"},{\"1\":\"Azerbaijan\",\"2\":\"AZE\",\"3\":\"3894500\",\"4\":\"4045750\",\"5\":\"4168150\",\"6\":\"4293550\",\"7\":\"4439250\",\"8\":\"4574650\",\"9\":\"4708150\",\"10\":\"4832000\",\"11\":\"4948500\",\"12\":\"5063300\",\"13\":\"5172050\",\"14\":\"5282950\",\"15\":\"5391450\",\"16\":\"5493900\",\"17\":\"5594100\",\"18\":\"5689050\",\"19\":\"5781000\",\"20\":\"5876150\",\"21\":\"5976150\",\"22\":\"6071300\",\"23\":\"6160500\",\"24\":\"6257750\",\"25\":\"6357550\",\"26\":\"6459800\",\"27\":\"6567850\",\"28\":\"6670150\",\"29\":\"6770300\",\"30\":\"6875350\",\"31\":\"6974600\",\"32\":\"7076550\",\"33\":\"7175200\",\"34\":\"7271300\",\"35\":\"7382050\",\"36\":\"7494800\",\"37\":\"7596550\",\"38\":\"7684850\",\"39\":\"7763000\",\"40\":\"7838250\",\"41\":\"7913000\",\"42\":\"7982750\",\"43\":\"8048600\",\"44\":\"8111200\",\"45\":\"8171950\",\"46\":\"8234100\",\"47\":\"8306500\",\"48\":\"8391850\",\"49\":\"8484550\",\"50\":\"8581300\",\"51\":\"8763400\",\"52\":\"8947243\",\"53\":\"9054332\",\"54\":\"9173082\",\"55\":\"9295784\",\"56\":\"9416801\",\"57\":\"9535079\",\"58\":\"9649341\",\"59\":\"9757812\",\"60\":\"9854033\",\"61\":\"9939771\",\"62\":\"10024283\",\"63\":\"10093121\",\"64\":\"10137750\",\"65\":\"10141756\",\"66\":\"10153958\",\"67\":\"10336578\",\"_rn_\":\"2\"},{\"1\":\"Belarus\",\"2\":\"BLR\",\"3\":\"8198000\",\"4\":\"8271216\",\"5\":\"8351928\",\"6\":\"8437232\",\"7\":\"8524224\",\"8\":\"8610000\",\"9\":\"8696496\",\"10\":\"8785648\",\"11\":\"8874552\",\"12\":\"8960304\",\"13\":\"9040000\",\"14\":\"9115576\",\"15\":\"9188968\",\"16\":\"9257272\",\"17\":\"9317584\",\"18\":\"9367000\",\"19\":\"9411000\",\"20\":\"9463000\",\"21\":\"9525000\",\"22\":\"9584000\",\"23\":\"9643000\",\"24\":\"9710000\",\"25\":\"9776000\",\"26\":\"9843000\",\"27\":\"9910000\",\"28\":\"9975000\",\"29\":\"10043000\",\"30\":\"10111000\",\"31\":\"10140000\",\"32\":\"10170000\",\"33\":\"10189348\",\"34\":\"10194050\",\"35\":\"10216470\",\"36\":\"10239050\",\"37\":\"10226955\",\"38\":\"10193831\",\"39\":\"10159569\",\"40\":\"10117433\",\"41\":\"10071963\",\"42\":\"10026738\",\"43\":\"9979610\",\"44\":\"9928549\",\"45\":\"9865548\",\"46\":\"9796749\",\"47\":\"9730146\",\"48\":\"9663915\",\"49\":\"9604924\",\"50\":\"9560953\",\"51\":\"9527985\",\"52\":\"9504583\",\"53\":\"9483836\",\"54\":\"9461643\",\"55\":\"9446836\",\"56\":\"9443211\",\"57\":\"9448515\",\"58\":\"9461076\",\"59\":\"9469379\",\"60\":\"9458989\",\"61\":\"9438785\",\"62\":\"9419758\",\"63\":\"9379952\",\"64\":\"9302585\",\"65\":\"9228071\",\"66\":\"9178298\",\"67\":\"9056696\",\"_rn_\":\"3\"},{\"1\":\"Kazakhstan\",\"2\":\"KAZ\",\"3\":\"9429981\",\"4\":\"9742085\",\"5\":\"10058928\",\"6\":\"10377466\",\"7\":\"10690309\",\"8\":\"10993183\",\"9\":\"11288989\",\"10\":\"11584428\",\"11\":\"11879182\",\"12\":\"12156212\",\"13\":\"12419057\",\"14\":\"12684813\",\"15\":\"12951798\",\"16\":\"13208121\",\"17\":\"13454570\",\"18\":\"13700843\",\"19\":\"13998738\",\"20\":\"14353265\",\"21\":\"14711497\",\"22\":\"14978696\",\"23\":\"15152949\",\"24\":\"15323082\",\"25\":\"15492595\",\"26\":\"15665551\",\"27\":\"15844621\",\"28\":\"16031090\",\"29\":\"16262702\",\"30\":\"16527715\",\"31\":\"16781168\",\"32\":\"16997013\",\"33\":\"17154054\",\"34\":\"17278600\",\"35\":\"17332625\",\"36\":\"17274487\",\"37\":\"17043771\",\"38\":\"16730536\",\"39\":\"16416027\",\"40\":\"16043251\",\"41\":\"15647785\",\"42\":\"15455874\",\"43\":\"15501103\",\"44\":\"15575550\",\"45\":\"15656677\",\"46\":\"15747380\",\"47\":\"15850159\",\"48\":\"15968117\",\"49\":\"16103716\",\"50\":\"16257214\",\"51\":\"16426525\",\"52\":\"16619846\",\"53\":\"16836810\",\"54\":\"17066002\",\"55\":\"17306106\",\"56\":\"17556502\",\"57\":\"17816285\",\"58\":\"18084169\",\"59\":\"18363600\",\"60\":\"18651931\",\"61\":\"18932727\",\"62\":\"19209555\",\"63\":\"19482117\",\"64\":\"19743603\",\"65\":\"20034609\",\"66\":\"20330104\",\"67\":\"20592571\",\"_rn_\":\"4\"},{\"1\":\"Kyrgyzstan\",\"2\":\"KGZ\",\"3\":\"2172300\",\"4\":\"2255900\",\"5\":\"2333400\",\"6\":\"2413700\",\"7\":\"2495300\",\"8\":\"2573300\",\"9\":\"2655300\",\"10\":\"2736500\",\"11\":\"2818300\",\"12\":\"2894800\",\"13\":\"2959900\",\"14\":\"3022300\",\"15\":\"3088200\",\"16\":\"3153800\",\"17\":\"3223900\",\"18\":\"3292400\",\"19\":\"3358700\",\"20\":\"3423900\",\"21\":\"3487100\",\"22\":\"3552000\",\"23\":\"3617400\",\"24\":\"3685800\",\"25\":\"3759300\",\"26\":\"3838300\",\"27\":\"3916400\",\"28\":\"3990300\",\"29\":\"4066500\",\"30\":\"4144600\",\"31\":\"4218400\",\"32\":\"4307500\",\"33\":\"4391236\",\"34\":\"4463634\",\"35\":\"4515400\",\"36\":\"4516777\",\"37\":\"4515069\",\"38\":\"4560454\",\"39\":\"4628438\",\"40\":\"4696421\",\"41\":\"4769015\",\"42\":\"4840422\",\"43\":\"4898362\",\"44\":\"4945073\",\"45\":\"4990704\",\"46\":\"5043308\",\"47\":\"5104713\",\"48\":\"5162640\",\"49\":\"5218373\",\"50\":\"5268385\",\"51\":\"5318729\",\"52\":\"5389643\",\"53\":\"5467059\",\"54\":\"5546587\",\"55\":\"5652076\",\"56\":\"5777150\",\"57\":\"5905848\",\"58\":\"6040036\",\"59\":\"6175338\",\"60\":\"6306696\",\"61\":\"6444079\",\"62\":\"6590211\",\"63\":\"6726596\",\"64\":\"6851224\",\"65\":\"6975220\",\"66\":\"7099750\",\"67\":\"7186009\",\"_rn_\":\"5\"},{\"1\":\"Russia\",\"2\":\"RUS\",\"3\":\"119897000\",\"4\":\"121236000\",\"5\":\"122591000\",\"6\":\"123960000\",\"7\":\"125345000\",\"8\":\"126745000\",\"9\":\"127468000\",\"10\":\"128196000\",\"11\":\"128928000\",\"12\":\"129664000\",\"13\":\"130404000\",\"14\":\"131155000\",\"15\":\"131909000\",\"16\":\"132669000\",\"17\":\"133432000\",\"18\":\"134200000\",\"19\":\"135147000\",\"20\":\"136100000\",\"21\":\"137060000\",\"22\":\"138027000\",\"23\":\"139010000\",\"24\":\"139941000\",\"25\":\"140823000\",\"26\":\"141668000\",\"27\":\"142745000\",\"28\":\"143858000\",\"29\":\"144894000\",\"30\":\"145908000\",\"31\":\"146857000\",\"32\":\"147721000\",\"33\":\"147969406\",\"34\":\"148394216\",\"35\":\"148538197\",\"36\":\"148458777\",\"37\":\"148407912\",\"38\":\"148375787\",\"39\":\"148160129\",\"40\":\"147915361\",\"41\":\"147670784\",\"42\":\"147214776\",\"43\":\"146596869\",\"44\":\"145976482\",\"45\":\"145306497\",\"46\":\"144648618\",\"47\":\"144067316\",\"48\":\"143518814\",\"49\":\"143049637\",\"50\":\"142805114\",\"51\":\"142742366\",\"52\":\"142785348\",\"53\":\"142849468\",\"54\":\"143018195\",\"55\":\"143378447\",\"56\":\"143805638\",\"57\":\"144237223\",\"58\":\"144640716\",\"59\":\"145015460\",\"60\":\"145293260\",\"61\":\"145398106\",\"62\":\"145453291\",\"63\":\"145245148\",\"64\":\"144746762\",\"65\":\"144236933\",\"66\":\"143826130\",\"67\":\"144820423\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n## data frame\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfmil <- function(x) round(x/1000000, digits = 2) # funk to x/Mill um zu verkürzen\n\n# dataframe\ndf <- \n  data |> \n  mutate(across(!c(country, ccode), fmil)) |> \n  pivot_longer(\n    cols = !c(country, ccode),\n    names_to = \"year\",\n    values_to = \"pop\"\n  ) |> \n  mutate(year = as.integer(year)) |> \n  group_by(year) |> \n  arrange(year, pop) |> #desc(pop)\n  mutate(rank = 1:n()) |> \n  ungroup()\n\nhead(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> # A tibble: 6 × 5\n#>   country      ccode  year   pop  rank\n#>   <chr>        <chr> <int> <dbl> <int>\n#> 1 Turkmenistan TKM    1960  1.64     1\n#> 2 Armenia      ARM    1960  1.86     2\n#> 3 Tajikistan   TJK    1960  2.11     3\n#> 4 Kyrgyzstan   KGZ    1960  2.17     4\n#> 5 Azerbaijan   AZE    1960  3.89     5\n#> 6 Belarus      BLR    1960  8.2      6\n```\n:::\n:::\n\n\n\n## plot for the year 2024\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npl24 <- \n  # data -----------------------------------------------\n  df |> \n  filter(\n    year==2024\n  ) |>\n  mutate(\n    images = case_when(\n      ccode == \"ARM\" ~ paste0(imgpat, \"AM.png\"),\n      ccode == \"AZE\" ~ paste0(imgpat, \"AZ.png\"),\n      ccode == \"BLR\" ~ paste0(imgpat, \"BY.png\"),\n      ccode == \"KAZ\" ~ paste0(imgpat, \"KZ.png\"),\n      ccode == \"KGZ\" ~ paste0(imgpat, \"KG.png\"),\n      ccode == \"RUS\" ~ paste0(imgpat, \"RU.png\"),\n      ccode == \"TJK\" ~ paste0(imgpat, \"TJ.png\"),\n      ccode == \"TKM\" ~ paste0(imgpat, \"TM.png\"),\n      ccode == \"UZB\" ~ paste0(imgpat, \"UZ.png\"),\n      TRUE ~ ccode)\n  ) |>\n  # plot aes ----------------------------------------------------\n  ggplot(aes(\n  xmin = 0,\n  xmax = pop,\n  y = rank,\n  ymin = rank - 0.45,\n  ymax = rank + 0.45,\n  fill = ccode)) +\n  geom_rect(alpha = 0.5) +\n  # axises, labels\n  scale_x_continuous(\n    limits = c(0,150),\n    breaks = seq(0, 150, 25),\n    labels = function(x) paste0(x, \"M\"),\n    expand = expansion(c(0.09, 0.0))) +\n  geom_image(aes(y= rank, image = images), \n             x = -10, size = 0.07, by=\"height\") + \n  geom_label(aes(x = pop, label = as.character(pop)), \n             colour = \"white\", hjust=0.0) +\n  geom_label(aes(label = paste(\"Year:\",year)),\n             x = 125, y = 2, size = 8, fill = \"white\", col = \"gray\") +\n  # title, caption ---------------------------------------------\n  labs(\n    x = \"Population (in millions)\",\n    y = NULL,\n    title = \"Population in CIS countries in 2024\",\n    caption = social_caption) +\n  # format, theme ----------------------------------------------\n  theme_minimal() +\n  theme(legend.position = \"none\",\n        plot.title = element_text(size=14, face = \"bold\", color=\"steelblue4\", hjust = 0.5 ),\n        plot.caption = ggtext::element_markdown(size=12, hjust = 0.5),\n        panel.grid.major.y = element_blank(),\n        panel.grid.minor.y = element_blank(),\n        panel.grid.minor.x = element_blank(),\n        axis.line.x =  element_line(colour = \"gray\"),\n        axis.text.y = element_blank())\n\n# show plot\npl24\n```\n\n::: {.cell-output-display}\n![](pop_bar_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n## Slopegraph in ggplot2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(CGPfunctions)\n\ngg <-\n  df |> \n  filter(\n  year==1990 | year==2024\n  ) |> \n  mutate(year=as.character(year))\n\n# graph\nnewggslopegraph(\n  dataframe = gg,\n  Times = year,Measurement = pop, Grouping = country,\n  Title = \"Population evolution in CIS countries\",\n  SubTitle = \"a comparison for the years: 1990-2024\",\n  Caption = \"Data Source: Worldbank | Plot by: \\u00A9ф\",\n  XTextSize = 18,    # Size of the times\n  YTextSize = 3,     # Size of the groups\n  TitleTextSize = 14,\n  SubTitleTextSize = 12,\n  CaptionTextSize = 12,\n  TitleJustify = \"right\",\n  SubTitleJustify = \"right\",\n  CaptionJustify = \"left\",\n  DataTextSize = 3.0\n) -> slop\n\nslop\n```\n\n::: {.cell-output-display}\n![](pop_bar_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n## range plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncflags <- c(\n  \"ARM\" = \"AM\", \"AZE\" = \"AZ\", \"BLR\" =\"BY\", \"KAZ\" = \"KZ\", \"KGZ\" =\"KG\", \n  \"RUS\" = \"RU\", \"TJK\" =\"TJ\", \"TKM\" = \"TM\", \"UZB\" = \"UZ\")\n# read images\nxlabels <- c()\nfor(i in 1:length(cflags)){\n  imgname <- names(cflags[i])\n  xlabels <- c(xlabels, paste0(\"<img src='\", imgpat, cflags[[i]], \".png' width='50' hight ='50'/>\"))\n}\n\n# named vector\nxnames <- names(cflags)\nnames(xlabels) <- xnames  # zum matchen nachher für plot labels\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggtext_st <- \"in <span style='color:#CB5416'>1990</span> and \n<span style='color:#267266'>2024</span> \\u00A9ф\"\n\nrr <-\n  # data ----------------------------------------------------\n  df |> \n  filter(\n    year==1990 | year==2024\n  ) |> \n  select(-c(country, rank)) |> \n  pivot_wider(\n    names_from = year,\n    values_from = pop\n  ) |> \n  # plot -----------------------------------------------------\n  ggplot(aes(x = ccode))+\n  geom_linerange(aes(ymin = `1990`, ymax = `2024`, x= ccode),\n                 size = 0.9, alpha = 0.5) +\n  geom_point(aes(y = `1990`), colour = \"#CB5416\", size=3) +\n  geom_point(aes(y = `2024`), colour = \"#267266\", size= 3) +\n  scale_x_discrete(name = NULL, labels =  xlabels)+\n  coord_flip()+\n  labs(\n    title =  \"Population in CIS countries\", \n    subtitle = ggtext_st,\n    caption = social_caption,\n    x = NULL,\n    y = NULL\n  ) +\n  # format -----------------------------------------------------\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(hjust = 0.5),\n    plot.subtitle = element_textbox(hjust = 0.5),\n    plot.caption = element_textbox(hjust = 0.5, size = 11),\n    axis.text.y = element_markdown()\n  )\n\nrr\n```\n\n::: {.cell-output-display}\n![](pop_bar_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n## plot animate\n\n### barplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Title/subtitle/datasource\n\npl <- \n  # data -----------------------------------------------\n  df |>\n  # filter(\n  #   year==2024\n  # ) |>\n  mutate(\n    images = case_when(\n      ccode == \"ARM\" ~ paste0(imgpat, \"AM.png\"),\n      ccode == \"AZE\" ~ paste0(imgpat, \"AZ.png\"),\n      ccode == \"BLR\" ~ paste0(imgpat, \"BY.png\"),\n      ccode == \"KAZ\" ~ paste0(imgpat, \"KZ.png\"),\n      ccode == \"KGZ\" ~ paste0(imgpat, \"KG.png\"),\n      ccode == \"RUS\" ~ paste0(imgpat, \"RU.png\"),\n      ccode == \"TJK\" ~ paste0(imgpat, \"TJ.png\"),\n      ccode == \"TKM\" ~ paste0(imgpat, \"TM.png\"),\n      ccode == \"UZB\" ~ paste0(imgpat, \"UZ.png\"),\n      TRUE ~ ccode)\n  ) |>\n  # plot aes ----------------------------------------------------\n  ggplot(aes(\n  xmin = 0,\n  xmax = pop,\n  y = rank,\n  ymin = rank - 0.45,\n  ymax = rank + 0.45,\n  fill = ccode)) +\n  geom_rect(alpha = 0.5) +\n  # axises, labels\n  scale_x_continuous(\n    limits = c(0,150),\n    breaks = seq(0, 150, 25),\n    labels = function(x) paste0(x, \"M\"),\n    expand = expansion(c(0.09, 0.0))) +\n  geom_image(aes(y= rank, image = images), \n             x = -10, size = 0.07, by=\"height\") + \n  geom_label(aes(x = pop, label = as.character(pop)), \n             colour = \"white\", hjust=0.0) +\n  geom_label(aes(label = paste(\"Year:\",year)),\n             x = 125, y = 2, size = 8, fill = \"white\", col = \"gray\") +\n  # title, caption ---------------------------------------------\n  labs(\n    x = \"Population (in millions)\",\n    y = NULL,\n    title = \"Population evolution in CIS countries in 1960-2024\",\n    caption = social_caption) +\n  # format, theme ----------------------------------------------\n  theme_minimal() +\n  theme(legend.position = \"none\",\n        plot.title = element_text(size=14, face = \"bold\", color=\"steelblue4\", hjust = 0.5 ),\n        plot.caption = ggtext::element_markdown(size=12, hjust = 0.5),\n        panel.grid.major.y = element_blank(),\n        panel.grid.minor.y = element_blank(),\n        panel.grid.minor.x = element_blank(),\n        axis.line.x =  element_line(colour = \"gray\"),\n        axis.text.y = element_blank())\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# animate\npl_anim <-\n  pl +\n  transition_states(year,wrap = FALSE, transition_length = 64) + #, transition_length = \n  ease_aes(\"cubic-in-out\") +\n  enter_fade()+\n  exit_fade()#+\n  #shadow_mark()\n\n#pl_anim\n\nanim <- animate(\n  pl_anim,\n  duration = 32,\n  start_pause =5,\n  end_pause = 5,\n  renderer = gifski_renderer()\n)\nanim\n```\n\n::: {.cell-output-display}\n![](pop_bar_files/figure-html/unnamed-chunk-10-1.gif)\n:::\n:::\n\n\n\n### treemap\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# library(treemapify)\npl_tm <-\n  df |> \n  filter(year >= 1990) |> \n  ggplot(aes(\n    area = pop, fill = country,\n    label = paste(country, paste0(pop, \" Mln\"), sep = \"\\n\"))) +\n  geom_treemap()+\n  geom_treemap_text(\n    colour = \"white\",\n    place = \"centre\",\n    #face = \"bold\", # ohne grow = TRUE zu benutzen\n    #size = 10,     # ohne grow = TRUE zu benutzen\n    grow = TRUE) +\n  labs(\n    title = \"Population in CIS countries for the year: {(frame_time)}\",\n    caption = social_caption) +\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(colour =  \"steelblue\", size = 15, face = \"bold\", hjust = 0.5),\n    plot.caption = element_textbox(hjust = 0.5, size = 12)) +\n  transition_time(time = year)\n\nanim_tm <- animate(\n  pl_tm,\n  duration = 30,\n  start_pause =5,\n  end_pause = 5,\n  renderer = gifski_renderer()\n)\nanim_tm\n```\n\n::: {.cell-output-display}\n![](pop_bar_files/figure-html/unnamed-chunk-11-1.gif)\n:::\n:::\n",
    "supporting": [
      "pop_bar_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}